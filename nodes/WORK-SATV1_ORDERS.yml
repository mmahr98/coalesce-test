steps:
  SATV1_ORDERS-274b4805-168b-4fe3-a2ba-1185006568e6:
    operation:
      config:
        postSQL: ""
        preSQL: ""
      database: ""
      deployEnabled: true
      description: Orders data as defined by TPC-H
      isDataVault: false
      isMultisource: false
      locationName: WORK
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 79f7ca6e-928a-4c44-9545-0be8fe63c20a
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            config:
              is_hk: true
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: HK_ORDERS_H
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ebcee7a2-429f-4046-b3fd-19d2459c6099
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: 3f14b7ab-4782-49c4-ba6a-a813dbbe83ec
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: HD_ORDERS_N_S
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b17363c4-dcec-4cb6-b7cd-9b63606485c2
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: 73260d96-16fc-450a-9762-cb7ae95784f2
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: TIMESTAMP
            description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
            hashColumns: []
            hashDetails: null
            name: LDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7335cd61-1a1f-4ffb-bec6-38c1811a4375
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: fb66e393-5863-4149-a5ca-e3e9227790a1
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: STRING
            description: The Record Source (RSRC) describes the source of this data.
            hashColumns: []
            hashDetails: null
            name: RSRC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c2571946-cf9d-4ca7-b812-f0871b562da2
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: 897cb353-5b09-4cfa-91e8-5bbf82fdf85a
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f8df3e74-b069-4071-8dde-57d67e050306
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: 74d039b3-c1b5-45a1-b991-432b55476a60
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 230a0051-a430-40e3-a8e9-72a176dcb0f1
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: 3bdcefb7-a576-4c0b-819c-edd1f184aa0f
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1e6cfe2c-6cfb-4c2b-9f1b-c16e5e42d16f
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: 85742e2a-6b5b-41b7-aca0-161e467c945d
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 779794e1-40b6-4f96-a6e6-a799049bf8b3
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: 5132a10b-4b6e-437e-8f8f-608d6d527efe
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ab4f045e-b17b-4dde-822d-6978e9bbd11f
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: 6bc61559-f590-40b8-8524-17055422932e
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 81d61849-2fcf-404e-ad7f-e557b7a240e1
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - columnReference:
              columnCounter: ba427ba7-b45b-49f6-ba29-75996a19142b
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a5b0a967-c8ba-4264-aa5e-4241243307ae
                    stepCounter: 7ceae95c-5ef3-4a5d-95f1-f4acdfa50da9
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: eba6fd41-945d-445f-8313-8d6450840078
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_ledts: true
            name: LEDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 48aff88f-9b81-40cc-b138-9b1a3ab26dee
              stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_current_col: true
            name: IS_CURRENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE 
                    WHEN 
                      LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                      OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                      ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                    THEN TRUE 
                    ELSE FALSE 
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: SATV0_ORDERS
            join:
              joinCondition: FROM {{ ref('WORK', 'SATV0_ORDERS') }} "SATV0_ORDERS"
            name: SATV1_ORDERS
            noLinkRefs: []
      name: SATV1_ORDERS
      overrideSQL: false
      schema: ""
      sqlType: "6"
      type: sql
    stepCounter: 274b4805-168b-4fe3-a2ba-1185006568e6
